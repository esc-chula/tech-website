'use client'

import { useEffect, useState } from 'react'
import { QrReader } from 'react-qr-reader'

import { findTeamTicketByPublicId } from '~/server/actions/hackathon'
import { type HackathonTeam } from '~/types/hackathon'

const Page: React.FC = () => {
  const [qrData, setQrData] = useState<string | null>(null)
  const [loading, setLoading] = useState(false)
  const [teamData, setTeamData] = useState<HackathonTeam | null>(null)

  useEffect(() => {
    if (qrData) {
      findTeamTicketByPublicId(qrData)
        .then((res) => {
          console.log(res)
        })
        .catch((err: unknown) => {
          console.error(err)
        })
    }
  }, [qrData])

  return (
    <div className='min-h-dvh w-full'>
      <div className='relative mx-auto w-full max-w-screen-sm'>
        <div className='absolute left-1/2 top-1/2 z-10 aspect-square w-1/2 -translate-x-1/2 -translate-y-1/2 rounded-3xl border-[3px] border-white/50' />
        <QrReader
          className='aspect-square w-full'
          constraints={{}}
          onResult={(result) => {
            if (result) {
              setQrData(result.getText())
            }
          }}
        />
        <p>{qrData}</p>
      </div>
    </div>
  )
}

export default Page
